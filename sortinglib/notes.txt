1) will not work on floating types because of ceiling function

2) delete reduction messages